<?xml version="1.0" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>rrdbuild</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<link rev="made" href="mailto:root@localhost" />
</head>

<body style="background-color: white">

<p><a name="__index__"></a></p>
<!-- INDEX BEGIN -->
<!--

<ul>

	<li><a href="#name">NAME</a></li>
	<li><a href="#overview">OVERVIEW</a></li>
	<li><a href="#optimistic_build">OPTIMISTIC BUILD</a></li>
	<li><a href="#installing_dependencies">INSTALLING DEPENDENCIES</a></li>
	<ul>

		<li><a href="#opensolaris_2008_05">OpenSolaris 2008.05</a></li>
		<li><a href="#debian___ubuntu">Debian / Ubuntu</a></li>
	</ul>

	<li><a href="#building_dependencies">BUILDING DEPENDENCIES</a></li>
	<ul>

		<ul>

			<li><a href="#build_tipps_for_aix">Build Tipps for AIX</a></li>
		</ul>

		<li><a href="#building_libraries">Building Libraries</a></li>
	</ul>

	<li><a href="#author">AUTHOR</a></li>
</ul>
-->
<!-- INDEX END -->

<p>
</p>
<h1><a name="name">NAME</a></h1>
<p>rrdbuild - Instructions for building RRDtool</p>
<p>
</p>
<hr />
<h1><a name="overview">OVERVIEW</a></h1>
<p>If you downloaded the source of rrdtool you have to compile it. This
document will give some information on how this is done.</p>
<p>RRDtool relies on services of thrid part libraries. Some of these libraries
may already be installed on your system. You have to compile copies of the other
ones before you can build RRDtool.</p>
<p>This document will tell you about all the necessary steps to get going.</p>
<p>These instructions assume you are using a <strong>bash</strong> shell. If you use csh/tcsh,
then you can either type <em>bash</em> to switch to bash for the compilation or if
you know what you are doing just replace the export bits with
setenv.</p>
<p>We further assume that your copies of <strong>tar</strong> and <strong>make</strong> are actually <strong>GNU
tar</strong> and <strong>GNU make</strong> respectively. It could be that they are installed as
<strong>gtar</strong> and <strong>gmake</strong> on your system.</p>
<p>
</p>
<hr />
<h1><a name="optimistic_build">OPTIMISTIC BUILD</a></h1>
<p>Before you start to build RRDtool, you have to decide two things:</p>
<ol>
<li>
<p>In which directory you want to build the software.</p>
</li>
<li>
<p>Where you want to install the software.</p>
</li>
</ol>
<p>Once you have decided. Save the two locations into environment variables.</p>
<pre>
 BUILD_DIR=/tmp/rrdbuild
 INSTALL_DIR=/usr/local/rrdtool-1.3rc4</pre>
<p>If your <em>/tmp</em> is mounted with the option noexec (RHEL seems todo that) you have to choose
a different directory!</p>
<p>Now make sure the BUILD_DIR exists and go there:</p>
<pre>
 mkdir -p $BUILD_DIR
 cd $BUILD_DIR</pre>
<p>Lets first assume you already have all the necessary libraries
pre-installed.</p>
<pre>
 wget <a href="http://oss.oetiker.ch/rrdtool/pub/rrdtool-1.3rc4.tar.gz">http://oss.oetiker.ch/rrdtool/pub/rrdtool-1.3rc4.tar.gz</a>
 gunzip -c rrdtool-1.3rc4.tar.gz | tar xf -
 cd rrdtool-1.3rc4
 ./configure --prefix=$INSTALL_DIR &amp;&amp; make &amp;&amp; make install</pre>
<p>Ok, this was very optimistic. This try will probably have ended with
<strong>configure</strong> complaining about several missing libraries.</p>
<p>
</p>
<hr />
<h1><a name="installing_dependencies">INSTALLING DEPENDENCIES</a></h1>
<p>If your OS lets you install additional packages from a software repository,
you may get away with installing the missing packages. When the packages are
installed, run configure again and try to compile again. Below you find some
hints on getting your OS ready for the rrdtool compilation. Additions to
this list are welcome.</p>
<p>
</p>
<h2><a name="opensolaris_2008_05">OpenSolaris 2008.05</a></h2>
<p>Just add a compiler and the gnome development package:</p>
<pre>
 pkg install sunstudioexpress
 pkg install SUNWgnome-common-devel</pre>
<p>There is a a problem with <em>cairo.pc</em> on opensolaris. It suggests that
xrender is required for compilation with cairo. This is not true and also
bad since opensolaris does not include an <em>xrender.pc</em> file. Use perl to
fix this:</p>
<pre>
 perl -i~ -p -e 's/(Requires.*?)\s*xrender.*/$1/' /usr/lib/pkgconfig/cairo.pc</pre>
<p>
</p>
<h2><a name="debian___ubuntu">Debian / Ubuntu</a></h2>
<p>Use apt-get to make sure you have all that is required. A number
of packages will get added through dependencies.</p>
<pre>
 apt-get install libpango1.0-dev libxml2-dev</pre>
<p>
</p>
<hr />
<h1><a name="building_dependencies">BUILDING DEPENDENCIES</a></h1>
<p>But again this may have been too optimistic still, and you actually have to
compile your own copies of some of the required libraries. Things like
libpng and zlib are pretty standard so you will probably have them on your
system anyway. Freetype, Fontinst, Cairo, Pango may be installed, but it is
possible that they are pretty old and thus don't live up to the
expectations, so you may want to compile their latest versions.</p>
<p>
</p>
<h3><a name="build_tipps_for_aix">Build Tipps for AIX</a></h3>
<p>If you are woking with AIX, you may find the the <strong>--disable-shared</strong> option
will cause things to break for you. In that case you may have to install the
shared libraries into the rrdtool PREFIX and work with <strong>--disable-static</strong>
instead.</p>
<p>Another hint to get rrdtool working on AIX is to use the IBM XL C Compiler:</p>
<pre>
 export CC=/usr/vac/bin/cc
 export PERLCC=$CC</pre>
<p>(Better instructions for AIX welcome!)</p>
<p>
</p>
<h2><a name="building_libraries">Building Libraries</a></h2>
<p>In order to build the libraries you need a compiler on your system.
Unfortunately compilers are not all alike. This has an effect on the CFLAGS
you want to set. The examples below are for the popular GCC compiler suite.
If you have an other compile you have to use the following settings:</p>
<dl>
<dt><strong><a name="item_sun_forte">Sun Forte</a></strong>

<dd>
<pre>
 CFLAGS=&quot;-xO3 -kPIC&quot;</pre>
</dd>
</dl>
<p>Some libraries want to know where other libraries are. For this to work,
set the following environamen variable</p>
<pre>
 export PKG_CONFIG_PATH=${INSTALL_DIR}/lib/pkgconfig
 export PATH=$INSTALL_DIR/bin:$PATH</pre>
<p>Since we are compiling libraries dynamically, you they must further know
where to find each other. This is done by setting an appropriate LDFLAG.
Unfortunatly the syntax differs from system to system:</p>
<dl>
<dt><strong><a name="item_solaris">Solaris</a></strong>

<dd>
<pre>
 export LDFLAGS=-R${INSTALL_DIR}/lib</pre>
</dd>
<dt><strong><a name="item_linux">Linux</a></strong>

<dd>
<pre>
 export LDFLAGS=&quot;-Wl,--rpath -Wl,${INSTALL_DIR}/lib&quot;</pre>
</dd>
<dd>
<p>If you are on a 64bit platform, but would like to continue to use the rrd files created
on your old 32bit linux, you may be able</p>
</dd>
<dt><strong><a name="item_hpux">HPUX</a></strong>

<dd>
<pre>

 export LDFLAGS=&quot;+b${INSTALL_DIR}/lib&quot;</pre>
</dd>
<dt><strong><a name="item_aix">AIX</a></strong>

<dd>
<pre>
 export LDFLAGS=&quot;-Wl,-blibpath:${INSTALL_DIR}/lib&quot;</pre>
</dd>
<p>If you have GNUmake installed and it is not called 'make',
then do</p>
<pre>
 export MAKE=gmake
 export GNUMAKE=gmake</pre>
<p>otherwhise just do</p>
<pre>
 export MAKE=make</pre>
<dl>
<dt><strong><a name="item_building_zlib">Building zlib</a></strong>

<dd>
<p>Chances are very high that you already have that on your system ...</p>
</dd>
<dd>
<pre>
 cd $BUILD_DIR
 wget <a href="http://oss.oetiker.ch/rrdtool/pub/libs/zlib-1.2.3.tar.gz">http://oss.oetiker.ch/rrdtool/pub/libs/zlib-1.2.3.tar.gz</a>
 gunzip -c zlib-1.2.3.tar.gz | tar xf -
 cd zlib-1.2.3
 ./configure --prefix=$INSTALL_DIR CFLAGS=&quot;-O3 -fPIC&quot; --shared
 $MAKE
 $MAKE install</pre>
</dd>
</li>
<dt><strong><a name="item_building_libpng">Building libpng</a></strong>

<dd>
<p>Libpng itself requires zlib to build, so we need to help a bit. If you
already have a copy of zlib on your system (which is very likley) you can
drop the settings of LDFLAGS and CPPFLAGS. Note that the backslash (\) at
the end of line 4 means that line 4 and line 5 are on one line.</p>
</dd>
<dd>
<pre>
 cd $BUILD_DIR
 wget <a href="http://oss.oetiker.ch/rrdtool/pub/libs/libpng-1.2.18.tar.gz">http://oss.oetiker.ch/rrdtool/pub/libs/libpng-1.2.18.tar.gz</a>
 gunzip -c libpng-1.2.18.tar.gz | tar xf -
 cd libpng-1.2.10
 env CFLAGS=&quot;-O3 -fPIC&quot; ./configure --prefix=$INSTALL_DIR
 $MAKE
 $MAKE install</pre>
</dd>
</li>
<dt><strong><a name="item_building_freetype">Building freetype</a></strong>

<dd>
<pre>
 cd $BUILD_DIR
 wget <a href="http://oss.oetiker.ch/rrdtool/pub/libs/freetype-2.3.5.tar.gz">http://oss.oetiker.ch/rrdtool/pub/libs/freetype-2.3.5.tar.gz</a>
 gunzip -c freetype-2.3.5.tar.gz | tar xf -
 cd freetype-2.3.5
 ./configure --prefix=$INSTALL_DIR CFLAGS=&quot;-O3 -fPIC&quot;
 $MAKE
 $MAKE install</pre>
</dd>
<dd>
<p>If you run into problems building freetype on Solaris, you may want to try to
add the following at the start the configure line:</p>
</dd>
<dd>
<pre>
 env EGREP=egrep</pre>
</dd>
<dt><strong><a name="item_building_libxml2">Building LibXML2</a></strong>

<dd>
<pre>
 cd $BUILD_DIR
 wget <a href="http://oss.oetiker.ch/rrdtool/pub/libs/libxml2-sources-2.6.31.tar.gz">http://oss.oetiker.ch/rrdtool/pub/libs/libxml2-sources-2.6.31.tar.gz</a>
 gunzip -c libxml2-sources-2.6.32.tar.gz | tar xf -
 cd libxml2-sources-2.6.32
 ./configure --prefix=$INSTALL_DIR CFLAGS=&quot;-O3 -fPIC&quot;
 $MAKE
 $MAKE install</pre>
</dd>
<dt><strong><a name="item_building_fontconfig">Building fontconfig</a></strong>

<dd>
<p>Note that fontconfig has a runtime configuration file in INSTALL_DIR/etc you
may want to adjust that so that fontconfig finds the fonts on your system.
Run the fc-cache program to build the fontconfig cache after changeing the
config file.</p>
</dd>
<dd>
<pre>
 cd $BUILD_DIR
 wget <a href="http://oss.oetiker.ch/rrdtool/pub/libs/fontconfig-2.4.2.tar.gz">http://oss.oetiker.ch/rrdtool/pub/libs/fontconfig-2.4.2.tar.gz</a>
 gunzip -c fontconfig-2.4.2.tar.gz   | tar xf -
 cd fontconfig-2.4.2
 ./configure --prefix=$INSTALL_DIR CFLAGS=&quot;-O3 -fPIC&quot;
 $MAKE
 $MAKE install</pre>
</dd>
</li>
<dt><strong><a name="item_building_pixman">Building Pixman</a></strong>

<dd>
<pre>
 cd $BUILD_DIR
 wget <a href="http://oss.oetiker.ch/rrdtool/pub/libs/pixman-0.10.0.tar.gz">http://oss.oetiker.ch/rrdtool/pub/libs/pixman-0.10.0.tar.gz</a>
 gunzip -c pixman-0.10.0.tar.gz  | tar xf -
 cd fontconfig-2.4.2
 ./configure --prefix=$INSTALL_DIR CFLAGS=&quot;-O3 -fPIC&quot;
 $MAKE
 $MAKE install</pre>
</dd>
<dt><strong><a name="item_building_cairo">Building Cairo</a></strong>

<dd>
<pre>
 cd $BUILD_DIR
 wget <a href="http://oss.oetiker.ch/rrdtool/pub/libs/cairo-1.6.4.tar.gz">http://oss.oetiker.ch/rrdtool/pub/libs/cairo-1.6.4.tar.gz</a>
 gunzip -c cairo-1.4.10.tar.gz   | tar xf -
 cd cairo-1.4.10
 ./configure --prefix=$INSTALL_DIR \
    --enable-xlib=no \
    --enable-xlib-render=no \
    --enable-win32=no \
    CFLAGS=&quot;-O3 -fPIC&quot;
 $MAKE
 $MAKE install</pre>
</dd>
<dt><strong><a name="item_building_glib">Building Glib</a></strong>

<dd>
<pre>
 cd $BUILD_DIR
 wget <a href="http://oss.oetiker.ch/rrdtool/pub/libs/glib-2.15.4.tar.gz">http://oss.oetiker.ch/rrdtool/pub/libs/glib-2.15.4.tar.gz</a>
 gunzip -c glib-2.12.13.tar.gz  | tar xf -
 cd glib-2.12.13
 ./configure --prefix=$INSTALL_DIR CFLAGS=&quot;-O3 -fPIC&quot;
 $MAKE
 $MAKE install</pre>
</dd>
<dt><strong><a name="item_building_pango">Building Pango</a></strong>

<dd>
<pre>
 cd $BUILD_DIR
 wget <a href="http://oss.oetiker.ch/rrdtool/pub/libs/pango-1.21.1.tar.gz">http://oss.oetiker.ch/rrdtool/pub/libs/pango-1.21.1.tar.gz</a>
 gunzip -c pango-1.21.1.tar.gz  | tar xf -
 cd pango-1.21.1
 ./configure --prefix=$INSTALL_DIR CFLAGS=&quot;-O3 -fPIC&quot; --without-x
 $MAKE
 $MAKE install</pre>
</dd>
</dl>
<p>Now all the dependent libraries are built and you can try again. This time
you tell configure where it should be looking for libraries and include
files. This is done via environment variables. Depending on the shell you
are running, the syntax for setting environment variables is different.</p>
<p>And finally try building again. We disable the python and tcl bindings
because it seems that a fair number of people have ill configured python and
tcl setups that would prevent rrdtool from building if they are included in
their current state.</p>
<pre>
 cd $BUILD_DIR/rrdtool-1.3rc4
 ./configure --prefix=$INSTALL_DIR --disable-tcl --disable-python
 $MAKE clean
 $MAKE
 $MAKE install</pre>
<p>SOLARIS HINT: if you want to build  the perl module for the native perl (the
one shipping with solaris) you will need the sun forte compiler installed on
your box or you have to hand-tune bindings/perl-shared/Makefile while
building!</p>
<p>Now go to <em>$INSTALL_DIR</em><strong>/share/rrdtool/examples/</strong> and run them to see if
your build has been successful.</p>
<p>
</p>
<hr />
<h1><a name="author">AUTHOR</a></h1>
<p>Tobias Oetiker &lt;<a href="mailto:tobi@oetiker.ch">tobi@oetiker.ch</a>&gt;

</p>

</body>

</html>
